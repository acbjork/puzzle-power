
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Puzzle Power â€“ DNF Demo</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; background: #f7f7f7; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; vertical-align: top; }
    .winner { background: #d4edda; font-weight: bold; }
    .dnf { color: red; font-style: italic; }
  </style>
</head>
<body>
  <h1>ðŸ§© Puzzle Power â€“ Winner + DNF Demo</h1>
  <table>
    <thead>
      <tr>
        <th>Puzzle</th>
        <th>Adam</th>
        <th>Jonathan</th>
        <th>Winner</th>
      </tr>
    </thead>
    <tbody id="puzzle-rows"></tbody>
  </table>

  <script>
    const puzzles = ["Connections", "Strands", "Wordle", "Mini Crossword"];

    // Simulated current time: 12:45am (past 30-minute DNF window)
    const demoCurrentHour = 0;
    const demoCurrentMin = 45;

    const dummyResults = {
      Adam: {
        "Connections": null, // Adam forgot
        "Strands": "9 guesses, 1 hint",
        "Wordle": "5/6",
        "Mini Crossword": "1:12"
      },
      Jonathan: {
        "Connections": "5 guesses",
        "Strands": null, // Jonathan forgot
        "Wordle": "4/6",
        "Mini Crossword": "1:18"
      }
    };

    function isAfterDNFTime() {
      return demoCurrentHour > 0 || demoCurrentMin >= 30;
    }

    function labelResult(result) {
      return result ? result : (isAfterDNFTime() ? "DNF" : "");
    }

    function determineWinner(puzzle, aResult, jResult) {
      const parseTime = s => {
        const parts = s.split(":");
        return parts.length === 2 ? (parseInt(parts[0]) * 60 + parseInt(parts[1])) : Infinity;
      };

      const adamForfeit = !aResult && isAfterDNFTime();
      const jonForfeit = !jResult && isAfterDNFTime();

      if (adamForfeit && !jonForfeit) return "Jonathan";
      if (jonForfeit && !adamForfeit) return "Adam";
      if (adamForfeit && jonForfeit) return "None";

      if (!aResult || !jResult) return "";

      if (puzzle === "Mini Crossword") {
        const a = parseTime(aResult);
        const j = parseTime(jResult);
        if (a < j) return "Adam";
        if (j < a) return "Jonathan";
        return "Tie";
      }
      if (puzzle === "Wordle") {
        const a = parseInt(aResult?.[0]);
        const j = parseInt(jResult?.[0]);
        if (a < j) return "Adam";
        if (j < a) return "Jonathan";
        return "Tie";
      }
      if (puzzle === "Connections" || puzzle === "Strands") {
        const a = parseInt(aResult);
        const j = parseInt(jResult);
        if (a < j) return "Adam";
        if (j < a) return "Jonathan";
        return "Tie";
      }
      return "";
    }

    const tbody = document.getElementById("puzzle-rows");
    puzzles.forEach(puzzle => {
      const row = document.createElement("tr");
      const aRaw = dummyResults.Adam[puzzle];
      const jRaw = dummyResults.Jonathan[puzzle];
      const aDisplay = labelResult(aRaw);
      const jDisplay = labelResult(jRaw);
      const winner = determineWinner(puzzle, aRaw, jRaw);

      const td1 = document.createElement("td");
      td1.textContent = puzzle;

      const td2 = document.createElement("td");
      td2.textContent = aDisplay;
      if (aDisplay === "DNF") td2.classList.add("dnf");
      else if (winner === "Adam") td2.classList.add("winner");

      const td3 = document.createElement("td");
      td3.textContent = jDisplay;
      if (jDisplay === "DNF") td3.classList.add("dnf");
      else if (winner === "Jonathan") td3.classList.add("winner");

      const td4 = document.createElement("td");
      td4.textContent = winner || "";

      row.appendChild(td1);
      row.appendChild(td2);
      row.appendChild(td3);
      row.appendChild(td4);
      tbody.appendChild(row);
    });
  </script>
</body>
</html>
